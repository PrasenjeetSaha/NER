import pandas as pd
from datetime import datetime, timedelta

# Load the data from the Excel file
df = pd.read_excel("mock data.xlsx")

def get_payment_status(company_id=None, transaction_id=None):
    # Define the base SQL query
    query = "SELECT company_id, transaction_id, status FROM df WHERE "
    
    if company_id:
        query += f"company_id = {company_id}"
    elif transaction_id:
        query += f"transaction_id = {transaction_id}"
    else:
        return "Please provide either company_id or transaction_id."

    # Execute the query
    result = df.query(query)

    return result

def get_payment_history(company_id, date1=None, date2=None):
    if not date1 and not date2:
        # Assuming date2 is today's date and date1 is today - 3 months
        date2 = datetime.today()
        date1 = date2 - timedelta(days=3*30)
    elif date1 and not date2:
        # Assuming date2 is today's date if not provided
        date2 = datetime.today()
    elif not date1 and date2:
        # Assuming date1 is 3 months before date2 if date1 is not provided
        date1 = date2 - timedelta(days=3*30)

    # Define the base SQL query
    query = f"SELECT company_id, transaction_id, date, transaction_amount FROM df WHERE company_id={company_id} AND date BETWEEN '{date1}' AND '{date2}'"

    # Execute the query
    result = df.query(query)

    return result
